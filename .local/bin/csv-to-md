#!/usr/bin/env bash

self=$(basename ${0})
file=${1}

if [ $# != 1 ]; then
	printf >&2 "usage: %s <file>\n" ${self}
	exit 1
fi

if [ ! -f ${file} ]; then
	printf >&2 "%s: %s: No such file or directory\n" ${self} ${file}
	exit 2
fi

case ${self} in
csv-to-json)
	from="csv"
	into="json"
	;;
csv-to-md)
	from="csv"
	into="markdown"
	;;
esac

sqlite3 <<EOF
.mode ${from}
.import ${file} document
.mode ${into}
.output /dev/stdout
SELECT * FROM document;
EOF
